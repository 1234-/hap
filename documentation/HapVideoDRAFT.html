<html>
<head>
	<title>Hap Video DRAFT</title>
	<style type="text/css">
		ol{margin:0;padding:0}.c3{vertical-align:top;width:156pt;border-style:solid;border-color:#cccccc;border-width:1pt;padding:0.7pt 0.7pt 0.7pt 0.7pt}.c10{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c7{height:1px;width:33%}.c8{font-size:24pt;font-weight:bold}.c6{font-size:12pt;font-weight:bold}.c9{background-color:#cccccc}.c0{direction:ltr}.c1{line-height:1.0}.c2{height:11pt}.c5{color:#e06666}.c4{border-collapse:collapse}.title{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:24pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.15;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.15;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.15;text-align:left;color:#000000;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h5{padding-top:11pt;line-height:1.15;text-align:left;color:#000000;font-size:11pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.15;text-align:left;color:#000000;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}
	</style>
</head>
<body class="c10">
	<h1 class="c0"><a name="h.ap2heq705xnp"></a><span class="c8">Hap Video</span></h1>
	<p class="c0">
		<span class="c5">DRAFT DOCUMENT: All details of the format described may change.</span>
	</p>
	<h4 class="c0"><a name="h.fqzwuexeeior"></a><span class="c6">Introduction</span></h4>
	<p class="c0">
		<span>Hap stores video frames encoded using S3 Texture Compression such that they meet the requirements of the OpenGL texture_compression_s3tc extension</span><sup><a href="#ftnt1" name="ftnt_ref1">[1]</a></sup><span>. Hap permits further compression using one of two generic compression formats: LZF</span><sup><a href="#ftnt2" name="ftnt_ref2">[2]</a></sup><span>&nbsp;and Snappy</span><sup><a href="#ftnt3" name="ftnt_ref3">[3]</a></sup><span>.</span>
	</p>
	<p class="c0 c2">
		<span></span>
	</p>
	<p class="c0">
		<span>A frame consists of a header and data part. The header will be four bytes in length and records the size and format of the frame data. Frame data will immediately follow the frame header.</span>
	</p>
	<p class="c0 c2">
		<span></span>
	</p>
	<h4 class="c0"><a name="h.l8n40qidza42"></a><span class="c6">Frame Header</span></h4>
	<p class="c0">
		<span>The first three bytes of the header are an unsigned integer stored in little-endian byte order. This is the size of the frame data in bytes.</span>
	</p>
	<p class="c0 c2">
		<span></span>
	</p>
	<p class="c0">
		<span>The fourth byte of the header is an unsigned integer denoting the S3 and generic compression formats in which the data is stored. Its value and meaning will be one of the following:</span>
	</p>
	<p class="c0 c2">
		<span></span>
	</p>
	<a href="#" name="2398f46ee720d012123868280bedad869e09a71b"></a><a href="#" name="0"></a>
	<table cellpadding="0" cellspacing="0" class="c4">
		<tbody>
			<tr><td class="c3 c9"><p class="c0 c1"><span>Hexadecimal Byte Value</span></p></td><td class="c3 c9"><p class="c0 c1"><span>S3 Format</span></p></td><td class="c3 c9"><p class="c0 c1"><span>Generic Compressor</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xAB</span></p></td><td class="c3"><p class="c0 c1"><span>RGB DXT1</span></p></td><td class="c3"><p class="c0 c1"><span>None</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xBB</span></p></td><td class="c3"><p class="c0 c1"><span>RGB DXT1</span></p></td><td class="c3"><p class="c0 c1"><span>Snappy</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xCB</span></p></td><td class="c3"><p class="c0 c1"><span>RGB DXT1</span></p></td><td class="c3"><p class="c0 c1"><span>LZF</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xAC</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT1</span></p></td><td class="c3"><p class="c0 c1"><span>None</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xBC</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT1</span></p></td><td class="c3"><p class="c0 c1"><span>Snappy</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xCC</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT1</span></p></td><td class="c3"><p class="c0 c1"><span>LZF</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xAD</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT3</span></p></td><td class="c3"><p class="c0 c1"><span>None</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xBD</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT3</span></p></td><td class="c3"><p class="c0 c1"><span>Snappy</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xCD</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT3</span></p></td><td class="c3"><p class="c0 c1"><span>LZF</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xAE</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT5</span></p></td><td class="c3"><p class="c0 c1"><span>None</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xBE</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT5</span></p></td><td class="c3"><p class="c0 c1"><span>Snappy</span></p></td></tr>
			<tr><td class="c3"><p class="c0 c1"><span>0xCE</span></p></td><td class="c3"><p class="c0 c1"><span>RGBA DXT5</span></p></td><td class="c3"><p class="c0 c1"><span>LZF</span></p></td></tr>
		</tbody>
	</table>
	<p class="c0 c2">
		<span></span>
	</p>
	<h4 class="c0"><a name="h.w4rv0bhw94by"></a><span class="c6">Frame Data</span></h4>
	<p class="c0">
		<span>The remainder of the frame is the frame data, starting immediately after the header (four bytes after the start of the frame). The data is to be treated as indicated by the header.</span></p><p class="c0 c2"><span></span></p><p class="c0"><span>If a generic compressor is indicated then the frame data is to be decompressed accordingly. The result of that decompression will be data in the indicated S3 format. If no generic compressor is indicated, the frame data is in the indicated S3 format.</span>
	</p>
		<p class="c0 c2">
		<span></span>
	</p>
	<hr class="c7">
	<div>
		<p class="c0">
			<a href="#ftnt_ref1" name="ftnt1">[1]</a><span><a href="http://www.opengl.org/registry/specs/EXT/texture_compression_s3tc.txt">http://www.opengl.org/registry/specs/EXT/texture_compression_s3tc.txt</a></span>
		</p>
	</div>
	<div>
		<p class="c0">
			<a href="#ftnt_ref2" name="ftnt2">[2]</a><span><a href="http://oldhome.schmorp.de/marc/liblzf.html">http://oldhome.schmorp.de/marc/liblzf.html</a></span>
		</p>
	</div>
	<div>
		<p class="c0">
			<a href="#ftnt_ref3" name="ftnt3">[3]</a><span><a href="http://code.google.com/p/snappy/">http://code.google.com/p/snappy/</a></span>
		</p>
	</div>
</body>
</html>